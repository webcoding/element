
// Core base
// @import "../fn";


// Output
// -----------------------------------------------------------------------------

// .views,
// .view {
//   position: relative;
//   width: 100%;
//   height: 100%;
//   z-index: 500;
// }
// .views {
//   @include scrollable();
// }
// .view {
//   overflow: hidden;
//   box-sizing: border-box;
// }

// View Container
.#{$views-prefix} {
  position: relative;
  flex: 1 1 0;
  @include square(100%);
  overflow: hidden;
}

// View
.#{$view-prefix} {
  display: flex;
  flex-direction: column;
  position: absolute;
  left: 0;
  top: 0;
  @include square(100%);
  background: $body-background;

  // position: relative;
  max-height: 100%;
  overflow-x: hidden;
  overflow-y: scroll;

  // Fixes: https://github.com/amazeui/amazeui-touch/issues/8
  // @see https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/doc/uid/TP30001266-SW26
  // @see http://weblog.west-wind.com/posts/2015/Jun/05/IPad-Scroll-Issues-with-Fixed-Content
  // @see http://www.quirksmode.org/css/css2/overflowscrolling.html
  // - 如果声明的值为 `touch`，在结合 Container 使用时，Modal 的遮罩层在 iOS Safari 中会被截取遮挡
  //   原因是 Safari 真的用了原生控件来实现，对于有 -webkit-overflow-scrolling 的网页
  //   会创建一个 UIScrollView，提供子 layer 给渲染模块使用
  //   http://blog.csdn.net/hursing/article/details/9186199
  // - 可以尝试使用绝对定位的方式定位 kitchen-sink 中的 navbar 和 tabbar，以避免这一问题，
  //   提高交互体验，具体可参考 Framework7 的实现方式

  // 2016.05.06 update:
  // Modal 和 Notification 改为使用 portal 模式，即渲染的时候会插入到 body 下面，避免被 UIScrollView 截断
  -webkit-overflow-scrolling: touch;


  backface-visibility: hidden;
  // transform: translateZ(0);

  & > .#{$container-prefix} {
    flex: 1 1 0;
  }
}

// Animations
// -----------------------------------------------------------------------------

// sfl: Show From Left
@keyframes view-sfl-enter {
  from {
    transform: translate3d(-100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}

@keyframes view-sfl-leave {
  /*from {
    transform: translate3d(0, 0, 0);
  }*/
  to {
    opacity: .75;
    transform: translate3d(25%, 0, 0);
  }
}


// Show From Right
@keyframes view-sfr-enter {
  from {
    transform: translate3d(100%, 0, 0);
  }
  to {
    transform: translate3d(0, 0, 0);
  }
}

@keyframes view-sfr-leave {
  to {
    opacity: .75;
    transform: translate3d(-25%, 0, 0);
  }
}


// REVEAL
// -----------------------------------------------------------------------------

// Reveal From Feft
@keyframes view-rfl-enter {
  from {
    opacity: .75;
    transform: translate3d(75%, 0, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes view-rfl-leave {
  from {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
  to {
    opacity: 0;
    transform: translate3d(-100%, 0, 0);
  }
}

// Reveal From Right
@keyframes view-rfr-enter {
  from {
    opacity: .75;
    transform: translate3d(-25%, 0, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

@keyframes view-rfr-leave {
  to {
    opacity: 0.75;
    transform: translate3d(100%, 0, 0);
  }
}


// Transition: Show
// sfl: show-from-left
// sfr: show-from-right
// -----------------------------------------------------------------------------

%view-transition-common {
  animation-duration: $view-transition-duration;
  animation-timing-function: $view-transition-timing-function;
  animation-fill-mode: forwards;
}

.#{$view-prefix}-transition-sfr-enter-active,
.#{$view-prefix}-transition-sfl-enter-active {
  pointer-events: none;
  z-index: $z-index-view-top;
}

.#{$view-prefix}-transition-sfr-leave,
.#{$view-prefix}-transition-sfl-leave {
  pointer-events: none;
  z-index: $z-index-view-bottom;
}

// animation common
.#{$view-prefix}-transition-sfl-enter-active,
.#{$view-prefix}-transition-sfl-leave,
.#{$view-prefix}-transition-sfr-enter-active,
.#{$view-prefix}-transition-sfr-leave {
  @extend %view-transition-common;
}

.#{$view-prefix}-transition-sfr-enter-active {
  animation-name: view-sfr-enter;
}

.#{$view-prefix}-transition-sfl-enter-active {
  animation-name: view-sfl-enter;
}

.#{$view-prefix}-transition-sfr-leave {
  animation-name: view-sfr-leave;
}

.#{$view-prefix}-transition-sfl-leave {
  animation-name: view-sfl-leave;
}


// Transition: Reveal
// rfr: reveal from right
// rfl: reveal from left
// -----------------------------------------------------------------------------

.#{$view-prefix}-transition-rfr-enter-active,
.#{$view-prefix}-transition-rfl-enter-active {
  pointer-events: none;
  z-index: $z-index-view-bottom;
}

.#{$view-prefix}-transition-rfr-leave,
.#{$view-prefix}-transition-rfl-leave {
  pointer-events: none;
  z-index: $z-index-view-top;
}

// animation common
.#{$view-prefix}-transition-rfl-enter-active,
.#{$view-prefix}-transition-rfl-leave,
.#{$view-prefix}-transition-rfr-enter-active,
.#{$view-prefix}-transition-rfr-leave {
  @extend %view-transition-common;
}

.#{$view-prefix}-transition-rfr-enter-active {
  animation-name: view-rfr-enter;
}

.#{$view-prefix}-transition-rfr-leave {
  animation-name: view-rfr-leave;
}

.#{$view-prefix}-transition-rfl-enter-active {
  animation-name: view-rfl-enter;
}

.#{$view-prefix}-transition-rfl-leave {
  animation-name: view-rfl-leave;
}
